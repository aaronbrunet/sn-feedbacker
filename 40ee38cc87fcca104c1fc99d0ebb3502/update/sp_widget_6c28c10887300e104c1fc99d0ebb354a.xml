<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller=function($window,$scope,$timeout) {
  /* widget controller */
  var c = this;
  c.thumbs,c.comments,c.smileys,c.stars;
  c.score = 100;
  c.contact_me = true;

  c.raw_score = 0;
  
  c.normalizeScore = function(_type,_score){
	var score;
	switch(_type){
		case 'thumbs':
			score = _score == 'thumbs_up' ? 100 : 0;
		break;
		case 'smileys':
			score = parseInt(_score) * 25;
		break;
		case 'stars':
			score = (parseInt(_score)-1) * 25; 
		break;
		case 'score':
			score = parseInt(_score);
		break;
	}

	return score;
  };

  c.getGrade = function(_score){
	if(_score < 60){
		return 'F';
	}
	if(_score < 70){
		return 'D';
	}
	if(_score < 80) {
		return 'C';
	}
	if(_score < 90) {
		return 'B';
	}
	if(_score < 95){
		return 'A';
	}
	if(_score <= '100'){
		return 'A+';
	}
	return 'F';
  }

  c.checkValues = function(){
	console.log([c.thumbs,c.smileys,c.stars,c.comments,c.contact_me]);
	console.log($scope);
  };

  c.getScore = function(_type,_score){
	console.log([_type,_score,c.normalizeScore(_type,_score)]);
  };

	c.closeModal = function (){
		
		c.data.submit_state = 'submitting';
		$timeout(function(){ 
			
		}, 2000).then(function(){
			c.data.submit_state = 'submitted';
			$timeout(function(){
				console.log('Goodbye!');
				$scope.$parent.$parent.$dismiss();
			},1000).then(function(){
				
			});
			
		});
		
	}
  c.data.page = $window.location.href;

  console.log([c.data.page,c.data.me]);
};]]></client_script>
        <controller_as>c</controller_as>
        <css>.feedback-popup-container {&#13;
    margin: 1rem;&#13;
	padding: 1rem;&#13;
  &#13;
    &amp;.outer {&#13;
    	border: 1px solid grey;&#13;
	    background-color: white;&#13;
    }&#13;
    .feedback-section {&#13;
    display: flex;&#13;
    flex-direction: column;&#13;
    justify-items: center;&#13;
  }&#13;
&#13;
  .feedback-options {&#13;
      display: flex;&#13;
      align-self: center;&#13;
      flex-direction: row;&#13;
  }&#13;
&#13;
  .radio-item{&#13;
      display: none !important;&#13;
  }&#13;
  .radio-label {&#13;
      opacity: 0.3;&#13;
      font-size: xxx-large;&#13;
      padding: 0 1rem;&#13;
	  cursor: pointer;&#13;
  }&#13;
  .radio-item:checked + label,.include-star {&#13;
      opacity: 1;&#13;
      color: initial;&#13;
      color: $brand-primary;&#13;
    &amp;.bad {&#13;
    	color: $brand-danger;&#13;
    }&#13;
&#13;
  }&#13;
  &#13;
  textarea {&#13;
  	max-width: 100%;&#13;
  }&#13;
  &#13;
  .feedback-footer {&#13;
  	display: flex;&#13;
    justify-content: flex-end;&#13;
  }&#13;
  &#13;
}&#13;
&#13;
.loading {&#13;
   animation: spin 1s infinite linear;&#13;
&#13;
}&#13;
&#13;
@keyframes spin {&#13;
  0% {&#13;
  	transform: rotate(0deg);&#13;
  }&#13;
  50% {&#13;
  	transform: rotate(180deg);&#13;
  }&#13;
  100% {&#13;
  	transform: rotate(360deg);&#13;
  }&#13;
}&#13;
&#13;
</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id>feedback-body</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {
  
}]]></link>
        <name>Feedback body</name>
        <option_schema/>
        <public>true</public>
        <roles/>
        <script><![CDATA[(function() {
	gs.info(JSON.stringify(input));
	if(input && input.modal){
		data.options = input;
	} else {
		data.options = options;
	}
	console.log(input);
	data.smileys = [
		{value:0,icon:'fa-face-sad-cry'},
		{value:1,icon:'fa-face-frown'},
		{value:2,icon:'fa-face-meh'},
		{value:3,icon:'fa-face-smile'},
		{value:4,icon:'fa-face-grin-hearts'},
	];

	data.me = gs.getUserID();
	
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>aaron.brunet</sys_created_by>
        <sys_created_on>2024-03-02 16:31:08</sys_created_on>
        <sys_id>6c28c10887300e104c1fc99d0ebb354a</sys_id>
        <sys_mod_count>103</sys_mod_count>
        <sys_name>Feedback body</sys_name>
        <sys_package display_value="Feedbacker" source="x_snc_feedbacker">40ee38cc87fcca104c1fc99d0ebb3502</sys_package>
        <sys_policy/>
        <sys_scope display_value="Feedbacker">40ee38cc87fcca104c1fc99d0ebb3502</sys_scope>
        <sys_update_name>sp_widget_6c28c10887300e104c1fc99d0ebb354a</sys_update_name>
        <sys_updated_by>aaron.brunet</sys_updated_by>
        <sys_updated_on>2024-03-05 03:38:39</sys_updated_on>
        <template><![CDATA[<div class="feedback-popup-container">
  <p class="feedback-popup content">Your feedback is important to us!</p>
  <p class="feedback-popup content">How was your experience on this page?</p>  
  
  <div id="thumbs" class="feedback-section" ng-if="data.options.feedback_type == 'thumbs'">
    <div class="feedback-options">
      <input type="radio" class="radio-item" value="thumbs_down" name="thumbs" id="thumbs_down" ng-model="c.thumbs">
          <label class="radio-label bad" for="thumbs_down"><i class="fa-solid fa-thumbs-down"></i></label>
      <input type="radio" class="radio-item" value="thumbs_up" name="thumbs" id="thumbs_up" ng-model="c.thumbs">
          <label class="radio-label good" for="thumbs_up"><i class="fa-solid fa-thumbs-up"></i></label>
    </div>
    <div ng-if="c.thumbs == 'thumbs_up'">
      <p>Glad to hear it!</p>
    </div>
    <div ng-if="c.thumbs == 'thumbs_down'">
      <p>Sorry to hear that!</p>
    </div>
  </div>
  
  <div id="smileys" class="feedback-section" ng-if="data.smileys && data.smileys.length > 0">
    <div class="feedback-options">
      <span ng-repeat="s in data.smileys">
        <input  type="radio" class="radio-item" value="{{s.value}}" name="smileys" id="smileys-{{s.value}}" ng-model="c.smileys">
            <label class="radio-label" for="smileys-{{s.value}}">
                <i class="fa-solid {{s.icon}}"></i>
            </label>
      </span>
    </div>
    <div ng-if="c.smileys == 4">
      <p>Woohoo!</p>
    </div>
    <div ng-if="c.smileys == 3">
      <p>Glad to hear it!</p>
    </div>
    <div ng-if="c.smileys <= 2">
      <p>Sorry to hear that!</p>
    </div>
  </div>
  
  <div id="stars" class="feedback-section">
    <div class="feedback-options">
      <span ng-repeat="star in [1,2,3,4,5]">
        <input  type="radio" class="radio-item" value="{{star}}" name="stars" id="stars-{{star}}" ng-model="c.stars">
          <label class="radio-label {{star <= c.stars && 'include-star'}}" for="stars-{{star}}">
              <i class="fa-solid fa-star"></i>
          </label>
      </span>
    </div>
    <div ng-if="c.stars >= 3">
      <p>Glad to hear it!</p>
    </div>
    <div ng-if="c.stars < 3">
      <p>Sorry to hear that!</p>
    </div>
  </div>
  
  <div id="score" class="feedback-section">
    <input type="range" value="score" name="score" id="score-slider" min=0 max=100 step=1 ng-model="c.score">
    	<label class="" for="score">{{c.score || 0}}% ({{c.getGrade(c.score)}})</label>
    <div ng-if="c.score >= 70">
      <p>Glad to hear it!</p>
    </div>
    <div ng-if="c.score < 70">
      <p>Sorry to hear that!</p>
    </div>
  </div>
  
  <div id="comments" class="feedback-section" ng-if="data.options.allow_comments">
    <label for="comments">Tell us more!</label>
    <textarea name="comments" ng-model="c.comments" maxlength=500></textarea>
    <p ng-if="c.comments.length > 0">{{500 - c.comments.length || 500}}/500 characters remaining</p>
  </div>
  
  <div id="allow_contact">
  	<input type="checkbox" ng-model="c.contact_me" id="contact_me"/> 
    <label for="contact_me">I want to be contacted about this feedback</label>
  </div>
  
  <button ng-click="c.checkValues()">Check</button>
	<div class="feedback-footer">
	<button class="btn btn-default btn-primary" ng-click="c.closeModal()">
      <span ng-if="!c.data.submit_state">Submit feedback <i class="fa-solid fa-arrow-right"></i></span>
      <span ng-if="c.data.submit_state == 'submitting'">Submitting <i class="fa-solid fa-spinner loading"></i></span>
      <span ng-if="c.data.submit_state == 'submitted'">Submitted <i class="fa-solid fa-check"></i></span>
  </button>
</div>  
</div>
]]></template>
    </sp_widget>
</record_update>
